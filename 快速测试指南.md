# 🚀 快速测试指南

## ✅ 错误已修复！

之前的错误 `Cannot read property 'localFileSystem' of undefined` 已经修复。

## 📝 立即测试

### 1️⃣ 重新加载插件

在 **UXP Developer Tool** 中：
- 找到 "保存历史工具" 插件
- 点击右侧的 **刷新/重新加载** 按钮
- 或者先 Remove，然后重新 Add Plugin

### 2️⃣ 打开插件面板

在 **Photoshop** 中：
- 菜单：`插件 > 保存历史`
- 插件面板应该正常显示，包含三个按钮

### 3️⃣ 打开开发者工具

在插件面板上：
- **右键点击** 面板任意位置
- 选择 **"检查元素"** / **"Inspect Element"**
- 点击 **Console（控制台）** 标签

### 4️⃣ 查看初始化日志

应该看到类似这样的日志（无错误）：

```
=== 插件初始化开始 ===
✅ 模块加载成功
- Photoshop app: true
- Storage: true
- LocalFileSystem: true
✅ 保存按钮已绑定
✅ 测试按钮已绑定
✅ 清空按钮已绑定
[监听器] 开始设置保存事件监听器...
[监听器] ✅ save 事件监听器已设置
[监听器] ✅ saveAs 事件监听器已设置
[监听器] 所有保存事件监听器设置完成
开始渲染缩略图...
[渲染] 开始渲染缩略图...
[渲染] 历史记录数量: 0
[渲染] 无历史记录，显示空状态
=== 插件初始化完成 ===
💡 提示：打开控制台（右键 > 检查元素）查看详细日志
```

✅ **如果看到这些日志** = 插件加载成功！
❌ **如果看到红色错误** = 把错误信息告诉我

---

## 🎯 功能测试

### 测试 1：手动记录功能

1. 在 Photoshop 中 **新建一个文档**
2. 随便画点东西
3. **按 Ctrl+S 保存**（选择位置，例如桌面，文件名 `test.psd`）
4. 在插件面板点击 **"测试记录"** 按钮
5. 查看控制台和插件面板

**预期结果：**
- 控制台显示：`[记录] 记录完成: test.psd`
- 插件面板显示一个缩略图
- 缩略图显示文档预览

### 测试 2：自动保存监听

1. 修改刚才的文档（再画一笔）
2. **按 Ctrl+S 保存**
3. 等待 1-2 秒
4. 查看控制台

**预期结果：**
- 控制台显示：`[监听器] ✅ 检测到 save 事件!`
- 控制台显示：`[记录] 记录完成: test.psd`
- 插件面板的缩略图更新了

### 测试 3：另存为功能

1. 在 Photoshop 菜单选择 **文件 > 另存为**
2. 保存到不同的位置，文件名 `test2.psd`
3. 查看控制台和插件面板

**预期结果：**
- 控制台显示：`[监听器] ✅ 检测到 saveAs 事件!`
- 插件面板现在有 **2 个缩略图**（test.psd 和 test2.psd）

### 测试 4：覆盖保存功能

1. 再新建一个文档
2. 画点不同的内容
3. **双击**插件面板中的第一个缩略图（test.psd）
4. 在确认对话框中点击 **"确定"**

**预期结果：**
- 显示成功提示
- test.psd 文件被覆盖为新内容
- 缩略图更新为新内容

---

## 🎨 界面说明

插件界面包含：

### 按钮区域
- **保存当前文档** - 手动保存并记录（会弹提示）
- **测试记录** - 测试记录功能是否正常
- **清空历史** - 清空所有历史记录

### 提示信息
- 💡 使用 Ctrl+S 或菜单保存时会自动记录到历史
- 💡 双击缩略图可将当前打开的文档覆盖保存到该文件

### 缩略图网格
- 显示所有保存过的文档
- 每个缩略图显示：预览图、文件名、时间、尺寸
- 悬停显示删除按钮（×）
- 双击可覆盖保存

---

## ❓ 常见问题

### Q: 点击"测试记录"提示"文档还未保存过"？
**A:** 新文档需要先按 Ctrl+S 保存一次（选择保存位置），然后才能记录。

### Q: 按 Ctrl+S 后没有自动记录？
**A:** 
1. 确保文档已保存过（不是第一次保存）
2. 等待 1-2 秒（有延迟）
3. 查看控制台是否有 "检测到 save 事件" 日志
4. 如果没有，暂时使用"测试记录"按钮

### Q: 缩略图显示空白？
**A:** 
1. 文档可能太大，等待一会儿
2. 查看控制台是否有错误
3. 尝试较小的文档（<500MB）

### Q: 历史记录消失了？
**A:** 
1. 检查是否误点了"清空历史"
2. 检查浏览器缓存是否被清除
3. localStorage 数据会保留，除非手动清除

---

## 📊 测试清单

- [ ] 插件加载无错误
- [ ] 控制台显示 "模块加载成功"
- [ ] 可以看到三个按钮
- [ ] "测试记录" 功能正常
- [ ] Ctrl+S 保存后自动记录
- [ ] 另存为后创建新记录
- [ ] 双击缩略图可以覆盖保存
- [ ] 删除按钮可以删除记录
- [ ] 清空历史按钮正常工作

如果所有测试都通过，恭喜！插件完全正常！🎉

如果有任何问题，请把控制台的完整日志发给我！

